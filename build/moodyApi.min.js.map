{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap cabe760b5f782122c5e2","webpack:///external \"express\"","webpack:///external \"axios\"","webpack:///./src/index.js","webpack:///external \"babel-polyfill\"","webpack:///./src/controllers/articleRouter.js","webpack:///./src/services/article.js","webpack:///./src/services/crawler.js","webpack:///./src/services/Agolo.js","webpack:///external \"cheerio\"","webpack:///external \"colors\"","webpack:///external \"moment-timezone\"","webpack:///external \"underscore\"","webpack:///external \"puppeteer\"","webpack:///./src/constants/index.js","webpack:///external \"http\"","webpack:///external \"dotenv\""],"names":["process","env","NODE_ENV","require","config","app","server","createServer","use","listen","PORT","error","console","log","articleRouter","Router","get","req","res","articles","saveAndSummarizeToDb","results","status","send","message","article","projects","getAll","projectId","Article","crawler","getUrls","url","articleListSelector","green","bold","launch","headless","browser","newPage","page","goto","waitUntil","content","html","$","load","articleUrls","i","length","push","attribs","href","getContent","crawlParams","articlePrependUrl","articleHeaderSelector","articleDateSelector","articleTextSelector","hasWriter","hasHeader","hasDate","siteArticles","articleUrl","articleHeader","text","articleWriter","articleDate","articleText","date","header","writer","companies","allSitesArticles","company","siteArticlesWithInfo","name","j","originalText","originalHeader","options","title","summary_length","coref","sort_by_salience","include_all_sentences","summarizer","summarize","summary_title","summary_points","summarizedArticle","site_name","site_url","original_text","original_header","summarized","date_written","tz","format","Crawler","agolo","summarizer_options","AgoloAxios","create","baseURL","AGOLO_URL","headers","AGOLO_API_KEY","post","response","data","summary","sentences","Agolo","COMPANY_SITES","articleWriterSelector"],"mappings":"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","file":"moodyApi.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"api\"] = factory();\n\telse\n\t\troot[\"api\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cabe760b5f782122c5e2","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 1\n// module chunks = 0","import 'babel-polyfill';\n\nimport articleRouter from 'controllers/articleRouter';\nimport express from 'express';\nimport http from 'http';\n\nif (process.env.NODE_ENV === 'local') {\n  require('dotenv').config();\n}\n\nlet app = express();\n\n/* Creates server and web socket */\nconst server = http.createServer(app);\n\n/* Set up apps with routers and their root URLs here */\napp.use('/article', articleRouter);\n\n\n/* Initialize server locally */\nserver.listen(process.env.PORT, async (error) => {\n  if (error) {\n    console.log(`Error initializing server: ${error}`);\n  }\n  console.log(`Server is ready on http://localhost:${process.env.PORT}`);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 3\n// module chunks = 0","//@flow\nimport Article from 'services/article';\nimport express from 'express';\nimport Crawler from 'services/crawler'; // For test\n\nlet articleRouter = express.Router();\n\n/* Fetches the summarized articles in the last 24/7 given a project */\narticleRouter.get('/project/:projectId', async (req, res) => {\n  try {\n    const results = await Crawler.articles.saveAndSummarizeToDb();\n    // const { projectId } = req.params;\n    // const articles = await Article.projects.get(projectId);\n    // res.status(200).send('hello world');\n    // res.status(200).send(result);\n  } catch (error) {\n    res.status(500).send({ error: error.message });\n  }\n});\n\n\n\nexport default articleRouter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/articleRouter.js","//@flow\n\n// Fetch Articles from project from DB\n\nfunction article() {\n  this.projects = {\n    getAll: async () => {\n\n    },\n    get: async (projectId: string) => {\n\n    },\n  }\n  // this.prices = {\n  //   // Returns the current prices of all available currencies from Coinbase\n  //   getSpotAll: async({ currency }) => {\n  //     if (currency.toUpperCase() !== 'USD') {\n  //       throw new ('Error: We only allow USD for now');\n  //     }\n  //     const url: string = `https://api.article.com/v2/prices/${currency}/spot`;\n  //     const response: object = await request.get(url);\n  //     const data: array<any> = response.data.data;\n  //     let result: object  = { };\n  //     for (let i = 0; i < data.length; i ++) {\n  //       result[data[i].base] = `$${parseFloat(data[i].amount).toFixed(2)} ${data[i].currency}`;\n  //     }\n  //     return result;\n  //   },\n  // }\n}\n\nconst Article = new article();\nexport default Article;\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/article.js","//@flow\nimport axios from 'axios';\nimport Agolo from 'services/Agolo';\nimport { cheerio } from 'cheerio';\nimport colors from 'colors';\nimport moment from 'moment-timezone';\nimport { uniq } from 'underscore';\nimport puppeteer from 'puppeteer'\n\nimport { COMPANY_SITES } from '../constants';\n\n// Connect to DB\n\n// Types for Flow\ntype crawlParamsType = {\n  articleUrls: Array<string>,\n  articlePrependUrl: string,\n  articleHeaderSelector: string,\n  articleDateSelector: string,\n  articleTextSelector: string,\n  hasWriter: boolean,\n  hasHeader: boolean,\n  hasDate: boolean,\n}\n\ntype articleType = {\n  date: string,\n  header: string,\n  text: string,\n  writer: string,\n}\n\ntype siteArticlesWithInfoType = {\n  siteArticles: Array<articleType>,\n  name: string,\n  url: string,\n}\n\n// Similar to agolo.js, TOOD: Refactor to type.js file in constant\ntype summarizerOptions = {\n  title: string,\n  text: string,\n  summary_length: number,\n  coref: boolean,\n  sort_by_salience: boolean,\n  include_all_sentences: boolean,\n}\n\nfunction crawler() {\n  this.articles = {\n    /**\n     * @description Gets all articleUrls from a open news web page\n     */\n    getUrls: async (url: string, articleListSelector: string) => {\n      console.log(colors.green.bold(`> Crawling for article Urls ${url}`));\n      const browser = await puppeteer.launch({ headless: true });\n      const page = await browser.newPage();\n      await page.goto(url, { waitUntil: ['load', 'domcontentloaded', 'networkidle2'] });\n      const html = await page.content();\n      const $ = cheerio.load(html);\n      const articles = $(articleListSelector);\n      let articleUrls = [];\n\n      // Push all articles into array\n      for (let i = 0; i < articles.length; i++) {\n        articleUrls.push(`${articles[i].attribs.href}`);\n      }\n\n      // Clean articles to remove duplicate links if any\n      articleUrls = uniq(articleUrls);\n      console.log(colors.green.bold(`> Found ${articleUrls.length} unique article links`));\n      return articleUrls;\n    },\n    /**\n     * @description Gets article content from an article web page\n     */\n    getContent: async (crawlParams: crawlParamsType) => {\n      const {\n        articleUrls,\n        articlePrependUrl,\n        articleHeaderSelector,\n        articleDateSelector,\n        articleTextSelector,\n        hasWriter,\n        hasHeader,\n        hasDate\n      } = crawlParams;\n      let siteArticles = [];\n      for (let i = 0; i < articleUrls.length; i++) {\n        try {\n          const articleUrl = articleUrls[i];\n          console.log(colors.bold.green(`\\nScraping article url for content: ${articlePrependUrl}${articleUrl}`));\n          const browser = await puppeteer.launch({ headless: true });\n          const page = await browser.newPage();\n          await page.goto(`${articlePrependUrl}${articleUrl}`, { waitUntil: ['load', 'domcontentloaded', 'networkidle2'] });\n          const html = await page.content();\n          const $ = cheerio.load(html);\n          const articleHeader = hasHeader ? $(articleHeaderSelector).text() : '';\n          const articleWriter = hasWriter ? $(articleHeaderSelector).text() : '';\n          const articleDate = hasDate ? $(articleDateSelector).text() : '';\n          const articleText = $(articleTextSelector).text();\n          const article: articleType = {\n            date: articleDate,\n            header: articleHeader,\n            text: articleText,\n            writer: articleWriter,\n          }\n          // TODO: Do not push all article that are written more than 24 hours ago.\n          siteArticles.push(article);\n        } catch (error) {\n          console.log(`Error scraping url: ${articleUrls[i]}: \\n ${error.message}`);\n        }\n      }\n      return siteArticles;\n    },\n    /**\n     * @description Crawl all article urls from a list of company sites and subsequently crawl all their contents\n     */\n    getAll: async (companies: Array<any>) => {\n      let allSitesArticles = [];\n      for (let i = 0; i < companies.length; i++) {\n        const company = companies[i];\n        const articleUrls = await this.getUrls(company.url, company.articleListSelector);\n        const siteArticles = await this.getContent({\n          articleUrls: company.articleUrls,\n          articlePrependUrl: company.articlePrependUrl,\n          articleHeaderSelector: company.articleHeaderSelector,\n          articleDateSelector: company.articleDateSelector,\n          articleTextSelector: company.articleTextSelector,\n          hasWriter: company.hasWriter,\n          hasHeader: company.hasHeader,\n          hasDate: company.hasDate,\n        });\n        const siteArticlesWithInfo: siteArticlesWithInfoType = {\n          siteArticles,\n          name: company.name,\n          url: company.url,\n        }\n        allSitesArticles.push(siteArticlesWithInfo);\n      }\n      return allSitesArticles;\n    },\n    /**\n     * @description save each article from each\n     */\n    saveAndSummarizeToDb: async () => {\n      const allSitesArticles: Array<siteArticlesWithInfoType> = await this.getAll(COMPANY_SITES);\n      for (let i = 0; i < allSitesArticles.length; i++) {\n        const siteArticlesWithInfo: siteArticlesWithInfoType = allSitesArticles[i];\n        const { name, url, siteArticles } = siteArticlesWithInfo;\n        for (let j = 0; j < siteArticles.length; j++) {\n          const article: articleType = siteArticles[j];\n          const originalText: string = article.text;\n          const originalHeader: string = article.header;\n          const options: summarizerOptions = {\n            title: article.header,\n            text: article.text,\n            summary_length: 10,\n            coref: false,\n            sort_by_salience: true,\n            include_all_sentences: false,\n          };\n          const { summary_title, summary_points } = await Agolo.summarizer.summarize(options);\n          const summarizedArticle = {\n            summary_title,\n            summary_points,\n            site_name: name,\n            site_url: url,\n            original_text: originalText,\n            original_header: originalHeader,\n            summarized: true,\n            date_written: article.date ? moment(article.date).tz('America/New_York').format('L') : moment().tz('America/New_York').format('L'),\n          }\n          // Save to DB.\n          console.log('> Summarized Article:', summarizedArticle);\n        }\n      }\n    }\n  }\n}\n\nconst Crawler = new crawler();\nexport default Crawler;\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/crawler.js","//@flow\nimport axios from 'axios';\n\n// Connect to DB\n\n// Types for flow\ntype summarizerOptions = {\n  title: string,\n  text: string,\n  summary_length: number,\n  coref: boolean,\n  sort_by_salience: boolean,\n  include_all_sentences: boolean,\n}\n\nfunction agolo() {\n  this.summarizer = {\n    summarize: async (options: summarizerOptions) => {\n      // Prepare options for summarizing\n      const { title, text, summary_length, coref, sort_by_salience, include_all_sentences } = options;\n      const article = { title, text };\n      const summarizer_options = {\n        summary_length,\n        articles: [article],\n        coref,\n        sort_by_salience,\n        include_all_sentences,\n      };\n      // Request for Agolo's API\n      const AgoloAxios = axios.create({\n        baseURL: process.env.AGOLO_URL,\n        headers: {\n          'Content-Type': 'application/json',\n          'Ocp-Apim-Subscription-Key': process.env.AGOLO_API_KEY,\n        }\n      });\n      // Make request to Agolo Summarizer API & return\n      const response = await AgoloAxios.post('/', summarizer_options);\n      return ({ summary_title: response.data.title, summary_points: response.data.summary[0].sentences });\n    },\n  }\n}\n\nconst Agolo = new agolo();\nexport default Agolo;\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/Agolo.js","module.exports = require(\"cheerio\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cheerio\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"colors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"colors\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"moment-timezone\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment-timezone\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"underscore\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"underscore\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"puppeteer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"puppeteer\"\n// module id = 12\n// module chunks = 0","export const COMPANY_SITES = [\n  {\n    name: 'Dubai Holding',\n    url: 'https://dubaiholding.com/en/media-hub/press-releases/',\n    articlePrependUrl: '',\n    articleListSelector: 'div.summary-wrap > h4 > a',\n    articleHeaderSelector: 'div.container > h2',\n    articleDateSelector: 'div.container > strong',\n    articleTextSelector: 'div.container > p',\n    articleWriterSelector: '',\n    hasWriter: false,\n    hasHeader: true,\n    hasDate: true,\n  },\n  // {\n  //   name: 'Dubai Duty Free',\n  //   url: 'https://www.dubaidutyfree.com/media_center/news',\n  //   articlePrependUrl: 'https://www.dubaidutyfree.com/', // Some hrefs need to be prepended\n  //   articleListSelector: 'div.col-md-6.awards-blk > a.item-title',\n  //   articleHeaderSelector: 'span.item-title',\n  //   articleDateSelector: 'span.date',\n  //   articleTextSelector: 'div.col-md-12.awards-details > p',\n  //   articleWriterSelector: '',\n  //   hasWriter: false,\n  //   hasHeader: true,\n  //   hasDate: true,\n  // },\n  // {\n  //   name: 'du',\n  //   url: 'http://www.du.ae/about-us/media-centre/news',\n  //   articlePrependUrl: '',\n  //   articleListSelector: 'div.media-content > p > a.press-release-title',\n  //   articleHeaderSelector: 'h1.title.news-title',\n  //   articleDateSelector: 'p.news-date',\n  //   articleTextSelector: 'div.contentIn div:nth-child(6)',\n  //   articleWriterSelector: '',\n  //   hasWriter: false,\n  //   hasHeader: true,\n  //   hasDate: true,\n  // },\n  // {\n  //   name: 'Al Futtaim',\n  //   url: 'http://www.alfuttaim.com/home/mediacentre/News?className=AllNews&brandSelector=News&newscategory=AFGCorporate_design/MediaCentre/News/AllNews',\n  //   articlePrependUrl: 'http://www.alfuttaim.com',\n  //   articleListSelector: 'div.col-md-4.col-sm-6.col-xs-12 > a',\n  //   articleHeaderSelector: 'h2.news-video-details__title',\n  //   articleDateSelector: 'div.news-video-details__content__header',\n  //   articleTextSelector: 'div.news-video-details__content__detail.Description > p',\n  //   articleWriterSelector: '',\n  //   hasWriter: false,\n  //   hasHeader: true,\n  //   hasDate: true,\n  // },\n  // {\n  //   name: 'Dubai Electricity and Water Authority',\n  //   url: 'https://www.dewa.gov.ae/en/about-dewa/news-and-media/press-and-news/latest-news',\n  //   articlePrependUrl: 'https://www.dewa.gov.ae/',\n  //   articleListSelector: 'div.m8-teaser > a',\n  //   articleHeaderSelector: 'h1.text__page-title',\n  //   articleDateSelector: 'div.text__content-subcopy',\n  //   articleTextSelector: 'div.m14-richtext > p',\n  //   articleWriterSelector: '',\n  //   hasWriter: false,\n  //   hasHeader: true,\n  //   hasDate: true,\n  // }\n  // USING RSS FROM GOOGLE NEWS ALERT - The article sites have routing problem.\n  // {\n  //   url: 'http://www.empower.ae/news.php',\n  //   articlePrependUrl: 'http://www.empower.ae/',\n  //   articleListSelector: '#news > p > a',\n  //   articleHeaderSelector: 'h3',\n  //   articleDateSelector: 'i',\n  //   articleTextSelector: 'div.col-lg-8.col-md-8.col-sm-8 p:nth-child(5)',\n  //   articleWriterSelector: '',\n  //   hasWriter: false,\n  //   hasHeader: true,\n  //   hasDate: true,\n  // },\n]\n\n\n// WEBPACK FOOTER //\n// ./src/constants/index.js","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 15\n// module chunks = 0"],"sourceRoot":""}